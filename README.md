# котbread шаблон

## После клонирования репозитория

```bash
yarn
yarn build
```

## Структура проекта

Используем yarn workspaces для разделения кода

1. `frontend` - все, что связано с фронтовой частью приложения
2. `backend` - все, что связано с бэкендовой частью приложения
3. `shared` - различные тайпскриптовые типы и утилиты, которые используются во `frontend` и `backend`

## Наименование веток

При создании ветки, нужно соблюдать формат:  
`<username>/<type: fix|feature|chore|refactor>/<small_description>`

1. `username` - ваше имя пользователя на gitlab
2. `type` - тип задачи

- `fix` - фикс каких-то багов
- `feature` - новая фича
- `chore` - какие-то работы по обновлению пакетов, конфигов, линтеров и тд...
- `refactor` - переработка уже имеющихся фичей

3. `small_description` - небольшое описание вашей задачи

Пример: `astukalov/refactor/speed-up-redis-cache`

## Общие правила написания кода

1. Комменты оставляем на русском языке
2. Настройки `typescript` предполагают максимально строгую проверку типов. Запрещается использовать `any` или `unknown`. В рамках исключения такое использование возможно, но только после согласования на ревью.
3. В проекте используется `eslint`. Желательно настроить автоформатирование.
4. В проекте используется `husky` для `pre-commit` проверки изменений. Запрещается делать любые коммиты в обход этих проверок

## Запуск `backend` или одного из инстансов.

1. Создайте файл `.env` в папке `packages/backend` или в папке с инстансом (`packages/backend/src/instances/`).
   В качестве образца используйте `.env.example` указанный в нужной вам папке.
2. Убедитесь, что у вас запущены mongodb и redis
3. В папке бекенда запустите `yarn dev:<название_папки_инстанса>`

## Запуск `backend` при помощи pm2

1. Создайте файл `.env` в папке `packages/backend`. В качестве образца используйте `.env.example` из каталога `/src`
2. В только что созданном `.env` укажите также те переменные, которые указаны в `.env.example` в `/src/instances`, там могут использоваться
   собственные переменные для успешной работы. Их также указывайте в `.env`, так как оттуда будут считываться все данные.
3. Убедитесь, что у вас запущены mongodb и redis
4. В папке `packages/backend` запустите `yarn pm:dev`

## Частые вопросы

### Ошибки связанные с `@kotbread-test/shared`

Так как `frontend` и `backend` тянут зависимости из собранной версии `@kotbread-test/shared` после внесения каких-либо изменений в `@kotbread-test/shared`, нужно перебилдить этот пакет.  
Если после этого ошибка осталась, вероятно нужно перезапустить TS server в вашем редакторе. В VS Code это можно сделать командой `Restart TS Server`
